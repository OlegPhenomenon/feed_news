  <main class="mt-4 mb-5">
    <div class="container">
      <div class="row mb-4">
        <%= form_with url: root_path,
                      method: :get, 
                      data: { 
                        controller: 'debounce',
                        debounce_target: 'form',
                        turbo_action: "advance",
                        turbo_frame: 'posts',
                        action: 'input->debounce#search' 
                            }, class: "divide-y divide-gray-200 space-y-10" do |f| %>

        <div class='col-3'>
          <div class='form-floating'>
            <%= f.select :sort_by, 
                      options_for_select([['Oldest', :published_at_asc],
                                          ['Newest', :published_at_desc]],
                                          selected: session[:published]&.to_sym || :published_at_asc),
                      { }, { class: 'form-select'} %>
            <%= f.label :sort_by, 'Sort by published' %>
          </div>
        </div>
        <% end %>
                            
      </div>

      <hr>

      <div class="row">
        <%= turbo_frame_tag 'pins' do %>
          <% if user_signed_in? && current_user&.pins.present? %>
            <%= render partial: 'feeds/pins', locals: { pins: @pins } %>
          <% end %>
        <% end %>

        <%= turbo_frame_tag 'posts' do %>
            <%= render partial: 'feeds/posts', locals: { posts: @posts} %>

            <% if @pagy.pages > 1 %>
              <div class="footer text-center mt-4" id="pagy">
                <%== pagy_nav(@pagy)%>
              </div>
            <% end %>
        <% end %>

      </div>
    </div>
  </main>
